---
layout:     post
title:      寻找Macro难友启示
subtitle:   名义粘性与最优货币政策
date:       2019-10-09
author:     YYJ
header-img: img/macro_pikachu_blog.png
catalog: true
tags:
    - Macro
---

# 前言

宏观的Flag立了很久了，在美帝终于能够抽出点时间出来，系统地学习新凯恩斯和DSGE模型。我虽然长期叶公好龙，但是教科书和学习资料倒确实收集了不少。比如最早想看[许文立老师的公众号](https://mp.weixin.qq.com/s?__biz=MzAwODY5MDA3NA==&mid=308242610&idx=1&sn=67809d0ef84507ef519962bc7118a4f4&chksm=0cc0c8473bb741513f750b9be44333322129ffcd8cc849f9d2fef4a5f336c6bf31a35c558dc2&scene=18&xtrack=1&key=17447d3e87a127908ae1f609db05aeafd201a5825b0317bc6988ca4e20fc5c08ea82f4affd906ad77ae4af39740ce638f0b3a414710316a9d83d90756d8b52e0b43ae76ca1d23cbf816fb5e7f71b4281&ascene=1&uin=Mjk0MzY1OTEwMw%3D%3D&devicetype=Windows+10&version=62060833&lang=zh_CN&pass_ticket=1yFtnmbNwub%2FUVtM6GWuJKJYmbeSVevNxMrZuwVJOEKZNzRIZA8qIOEimZQ72Ahy)入门，但是觉得内容比较零散学不深入；再后来学长推荐了[《宏观经济理论：动态一般均衡方法》](https://item.jd.com/11019697.html)一书，经过翻译的书看起来确实快些，但理解起来不如看原版方便，另外这本书对我这个懒人来说还是厚了点。再或者就是数学和技术奇多的大部头，比如隔壁李向阳老师的[《动态随机一般均衡(DSGE)模型：理论、方法和Dynare实践》](http://www.tup.com.cn/upload/books/yz/074344-01.pdf)，似乎不适合大部分本科生入门。总之，即便在字缝里盯上半天，也不过常常悟出“宏观吃人“四字。

不久和伯克利的博士学长聊天，他向我推荐了Jordi Gali的[*monetary policy inflation and the business cycle*](https://www.amazon.com/Monetary-Policy-Inflation-Business-Cycle/dp/0691133166)一书，后来我发现这本书也在徐文立老师公众号的推荐书单里，被列为必看经典。这本书从RBC模型讲起，绝大部分都在介绍新凯恩斯主义的一些Baseline models，里面使用的数学并不trivial,但是对绝大多数想要入门DSGE模型的同学来说应该是好接受的，建议配合高宏一起学习。这本书并不尝试面面俱到，逻辑线条很清晰，从无摩擦的真实经济周期模型框架依次加入货币，价格粘性，工资粘性，失业等等要素，每一章都会指出前一章模型与现实的出入，为什么加入或者修改相应的假设是重要的；它的直觉解释很清晰，在脉冲响应图之后都有大段直觉论述，对理解和记忆模型有很大的帮助。

<img src="https://github.com/yoursilver/yoursilver.github.io/blob/master/img/book-cover.jpg?raw=true " alt="book-cover" style="zoom:50%;" />

依我愚见，目前至少正统的宏观领域还是模型在先，不过编程水平捉鸡的我还是至少希望能有机会练练手。除了做书的配套习题，我觉得把经典的模型全部编一遍程也是很有收获的学习方法。前段时间看到一个挺漂亮的网站模板于是fork了一下，于是乎在论文写不出来的情况下，为了不让网站空着，我就暂且拿这些学习笔记充下数。我会在每次的文章中**注明一些原书省略或者没有阐明的地方，如果有幸能拉一两位伙伴入坑或者对在同读此书的小伙伴有帮助，我就已经十分满足了**。

# 宏观模型何以需要名义粘性

第一篇笔记首先帮我自己梳理一下逻辑框架。

以RBC（真实商业周期）理论为代表的新古典（new classical）模型中，不存在名义摩擦（nominal frictions）。产品和劳动力市场完全竞争，价格灵活调整。在消费者一侧，真实工资等于劳动和闲暇的边际替代率$$\frac{W}{P}=-\frac{U_n}{U_c}$$；在厂商一侧，真实工资等于边际产出$\frac{W}{P}=(1-\alpha)AN^{-\alpha}$，由此将劳动的供给和厂商的雇佣需求联系起来。另一方面，生产函数与市场出清假$$Y=C$$设将消费同产出联系起来。由此两个等式决定了产出（消费）、就业、真实工资与实际利率等等**真实变量**。在最基本的模型中，这些变量都仅仅受到技术冲击的影响，而与货币政策无关。举例而言，央行对利率的操控会完全被通胀预期吸收，对实际利率无法产生影响。总之，RBC模型的核心观点就是：不存在所谓的自然产出，或者说一切实现的产出都是“自然”的：现实中观察到的产出波动不是产出偏离了自然值，而是自然产出总是受到技术冲击而发生变动。一个随之而来的结论就是宏观货币政策是无效的。

<img src="https://github.com/yoursilver/yoursilver.github.io/blob/master/img/mankwin.png?raw=true" alt="mankwin" style="zoom:50%;" />

[^                                                              图片来自曼昆《宏观经济学》英文第九版第一章]: 

显而易见，这一激进观点从诞生之日其就受到激烈的批判。首先，短期产出波动意味着技术会在短时间内频繁波动，这似乎很难想像。由于技术无法观测，而且并不是立即应用于生产，这一观点也无法得到计量佐证，很难证伪。其次，很难将大萧条这样的长期衰退归因于技术的长期退步。即便将其应用局限于正常范围的经济波动，理论预测也与实际颇有出入。譬如，我们假设央行遵循泰勒规则 $$i_t = \rho +\Phi_\pi(\pi_t-\pi)+v_t, \Phi_\pi>1$$，由此调控利率:按照模型预测，如果发生外生的，紧缩性的货币政策冲击$v_t$（这是一个有点绕的概念，可以理解为当局对突发事件的反应，或者广义地说，某次货币政策调控的失误），由于**实际利率不受货币政策影响**，**名义利率和通胀率都会下降**（注意到$$i_t = r_t+E_t\pi_{t+1}$$，如果$i_t$上升，由于预期的自我实现，$\Phi_\pi\pi_t$会上升更多，与泰勒规则矛盾，这意味着$i_t$实际会下降），并且一般情况下**货币量会增加**（按照货币需求方程$$m_t-p_t = y_t-\eta i_t$$，$\eta$ 较大时存在流动性效应）。然而在现实中，**货币扩张往往伴随着通胀**。即便退一步，央行不是按照泰勒规则调控利率，而是控制货币总量，这时，货币的扩张会伴随更加剧烈的通胀，以及随之而来（预期通胀推高）的利率上升，**不存在流动性效应**（货币需求增长伴随着利率下降），理论仍然和现实有较大分歧，而其来源就在于名义中性。

这些分歧意味着，应该存在某种名义非中性的机制。上面的讨论启示我们，如果名义变量的调整能够影响实际利率$r_t$，比如**外生的政策冲击也能抬升**$r_t$（即存在实际的紧缩效应），那么名义利率就能够上升，且不会与泰勒规则矛盾，流动性效应也会显现。事实上，我们并不必须直接寻求名义变量通往实际利率的桥梁，**只要有一条传导路径将名义和实际连通**，剩下的变量可以根据两部内各自的传导关系来变化。这一桥梁就是NKPC（新凯恩斯菲利普斯曲线）$\pi_t=\beta E_t\pi_{t+1}+\kappa\tilde{y}_t$。其基本思想是引入价格粘性，即任何一期只有部分企业（比例为$1-\theta$）能够调整价格，且产品市场不再完全竞争，不同的产品之间的替代弹性有限，这样，能够调价的企业能够获得一定的垄断利润。如果有通胀压力，这部分企业就可以面临更高的价格，能够获得更多的利润，从而有激励更多地生产，带动产出偏离自然值。这一典型的新凯恩斯模型框架的基本特征就是，**名义粘性**。基本的方程包括：

代表性消费者的欧拉方程$$\tilde{y}_t=E_t\tilde{y}_{t+1}-\frac{1}{\sigma}(i_t-E_t\pi_{t+1}-r^n_t) \tag{1}$$

新凯恩斯菲利普斯曲线$$\pi_t=\beta E_t\pi_{t+1}+\kappa\tilde{y}_t            \tag{2}$$

利率规则$$i_t = \rho +\Phi_\pi\pi_t+\Phi_y\hat{y}+v_t, \Phi_\pi>1   \tag{3} $$

自然利率的决定式$$r^n_t=\rho-\sigma(1-\rho_a)\psi_{ya}a_t+(1-\rho_z)z_t    \tag{4}$$

其中$$v_t,a_t,z_t$$分别代表货币政策、技术与总需求冲击，在后面的calibration中分别服从系数为$\rho_v=0.5$,$\rho_a=0.9$,$\rho_z=0.5$的一阶自回归方程。利用前述4个方程可以求解四个主要变量$$r^n_t,\tilde{y}_t,\pi_t,i_t$$的脉冲响应函数。

然后再利用自然产出的决定式$$y^n_t = \psi_{ya}a_t+\psi_y  \tag{5}$$

货币需求函数 										$$m_t-p_t = y_t-\eta i_t \tag{6}$$

生产函数											 $$y_t = a_t+(1-\alpha)n_t \tag{7}$$

工资等于消费者边际替代率 $$\omega_t = \phi n_t+\sigma c_t \tag{8}$$

求解剩下的变量。

*Monetary* 书中给出了各状态变量在三种冲击下的脉冲响应函数图像。我会定期在 github 上更新dynare 程序[文件夹](https://github.com/yoursilver/yoursilver.github.io/tree/master/DSGE/1.baseline_nk)，里面会有这本书里涉及到的所有脉冲响应分析。在这一基准模型中（对应书中第三章），选取的参数恰好使得**货币政策冲击**$v_t$与**总需求冲击**$z_t$的规模相同，它们都进入（1）式，因此两者的**差别仅在于它们对名义变量的影响**。如果$v_t$上升0.25个基点，如下图中蓝线所示，正如我们所期望的那样，**实际利率与名义利率都上升**，这和$v_t$作为紧缩冲击的含义一致。而如果紧缩冲击的来源是总需求下降，即$z_t$下降0.5个基点（红线），人们在当期消费的需求减少，储蓄的动机增加，相应地为了吸引人们储蓄所需要的利率就下降，即$r^n$下降，而此时通胀预期也降低了，名义利率因而进一步走低。货币总量的变化的反应也有不同，但是不是对任何参数都必然。产出，价格，工资和就业在紧缩冲击下都相应下滑。

值得注意的是**正向的技术冲击**，直觉上被认为是有利于产出增长的因素，会造成紧缩效应。这是因为厂商没有预料到自然产出的增加，或者说没有意料到由于未来经济增长率提高，实际利率下降，当期总需求上升，普遍生产偏少。由于技术冲击相较持久（$\rho_a=0.9$），因此各状态变量的回复也较为缓慢。值得注意的是，由于产出增加和名义利率下降，人们对货币的需求增加的程度超过了紧缩效应。还有一点值得说明，在我们的模型中，$\rho_a = 0.9$，因此尽管$a_t$冲击的绝对量为1，但是真正进入模型的只有0.1，小于另外两个效应；然而技术冲击造成的后果显然更加显著，这恰恰是因为技术冲击更为持久，**对预期有更大的影响**。

<img src="https://www.github.com/yoursilver/yoursilver.github.io/blob/master/DSGE/1.baseline_nk/taylor-rule/Baseline.png?raw=true" style="zoom:80%;" />

以上若干公式中，利率规则并没有坚实的微观基础，现实中央行可能遵循别的原则。书中还分析了央行控制货币总量时经济对冲击的反应。此时，唯一不同的是将（4）式换成了

$$\Delta m_t = \rho_m\Delta m_{t-1}+\epsilon^m_t \tag{9}$$

如蓝线所示，外生的货币放量增加了货币供给，由于价格调整相对于货币供应调整的更加缓慢，因此实际货币增加，而根据货币需求方程（6），这就要求产出增加或者利率下降。在现有的参数下，产出增加了，但是名义利率也增加了，因此在这里没有流动性效应。但是，名义利率的增加并不妨碍实际利率的下降，实际效应仍为扩张。

在**控制货币**的前提下，外生的总需求或者技术冲击都不能改变货币量，这意味着所有实际和**名义变量都将会到初值**，并且都会超调（overshoot）。与**利率规则**不同的是，技术冲击现在不影响货币总量，而产出增长和通缩的效应大多抵消，根据货币需求方程（6），名义利率只有很小的变动，并且由于通胀预期降低，实际利率上升。而在**利率规则**下，实际利率下降。因此如果央行控制货币发行量，产出缺口和就业的衰退相较更显著，而在利率规则下，这些衰退部分被实际利率的下降所抵消。

<img src="https://www.github.com/yoursilver/yoursilver.github.io/blob/master/DSGE/1.baseline_nk/money-control/Baseline.png?raw=true" style="zoom:80%;" />

## 工资粘性

上述模型中，产品市场垄断竞争而劳动力市场完全竞争，但是各类劳动显然非同质，劳动者存在一定的议价能力，引入工资粘性$$\theta^w$$并赋予劳动者一定的垄断力量，模型还可以进一步扩充。记真实工资为$$\omega_t=w_t-p_t$$

产品通胀的菲利普斯曲线$$\pi^p_t = \beta*E_t\pi^p_{t+1}+\kappa^p\tilde{y}_t+\lambda_p\tilde{\omega}_t\tag{10}$$

工资通胀的菲利普斯曲线$$\pi^w_t = \beta*E_t\pi^w_{t+1}+\kappa^w\tilde{y}_t+\lambda_w\tilde{\omega}_t\tag{11}$$

自然产出和自然真实工资的决定式$$\begin{cases} \omega^n_t = \sigma y^n_t + \phi n^n_t + \mu^w \\ \omega^n_t = y^n_t-n^n_t-\mu^p\end{cases} \tag{12}$$

<u>**注意**原书中并没有求解$$y_n$$，然而，如果 $$\mu^w,\mu^p$$不为零，则自然产出的表达式和之前的模型不一样。事实上，只有价格粘性的模型对应着$$\mu^w=0$$。这本书好像一直不太在意自然产出表达式中的常数项$$\psi_y$$，这个常数项是进入泰勒规则的，然而实际上这个常数项至少在我们分析外生冲击的时候没有任何影响。</u>

还需要真实工资缺口$\tilde{\omega}_t$的定义式$$\tilde{\omega}_t= \omega_t - \omega^n_t \tag{13}$$

然后我们就可以分析在三种情况（同时存在价格和工资粘性，只存在工资粘性，只存在价格粘性）下经济对冲击的反应。譬如发生**0.25个基点的货币政策紧缩冲击($v_t$)**。图中的蓝线为基准模型，即两种名义粘性都存在。此时名义工资变化十分迟缓（事实上$\lambda_w = \frac{(1-\beta\theta^w)(1-\theta^w)}{\theta^w(1+\phi\epsilon^w)}$，远小于$\lambda_p=\frac{(1-\beta\theta^p)(1-\theta^p)(1-\alpha)}{\theta(1-\alpha+\alpha\epsilon^p)}$ )，实际工资的变化很小，以至于厂商面对的超额垄断利润变化不大（厂商的定价取决于未来其**超额**垄断利润，即高于正常垄断利润的部分，的贴现和，具其值越高，定价越低），他们的调价动机并不高，价格通胀也并不显著，于是货币当局的反应也不强烈，名义利率和实际利率双双走高，紧缩效应完全体现在产出下降。与之形成鲜明对比的是，如果工资可以灵活调整，厂商面临的超额垄断利润就会增加，从而会发生通货紧缩（直觉上比较不好理解的是，为什么垄断利润**加成**高的时候，定价反而低，要注意**加成**的含义和垄断利润本身是不一样的），以及相对和缓的产出下滑。

<img src="https://www.github.com/yoursilver/yoursilver.github.io/blob/master/DSGE/6.wage_regidity/vshock/wage_price_rigid_v.png?raw=true" style="zoom: 67%;" />

## 最优货币政策

产出和价格波动无疑对社会总体福利带来影响，一个随之而来的问题是：如何衡量这些影响，如何评价货币政策的优良？自然的想法是考虑代表性消费者的效用损失，从而最优的货币政策就应该最小化这个损失函数。在平衡路径附近将效用函数作对数线性展开，略去高于二次的且与货币政策无关的量：**简单示意推导，不妨略过**
$$
\begin{eqnarray}
U(t)-U & = & U_c C \frac{C_t-C}{C}+U_c C\frac{C_t-C}{C}\frac{Z_t-Z}{Z}+\frac{1}{2}U_{cc} C^2( \frac{C_t-C}{C})^2+U_n N \int_{0}^1 \frac{N(j)_t-N}{N}dt+\\
&&U_n N \int_{0}^1 \frac{N(j)_t-N}{N}dt\frac{Z_t-Z}{Z}+\frac{1}{2}U_{nn} N^2\int_{0}^1 (\frac{N(j)_t-N}{N})^2dt + t.i.p\\
&=&- U_cC(-\frac{1}{\epsilon^p}\tilde{y}_t+\frac{1}{2}\{\frac{\epsilon_p}{\Theta}var[p(i)_t]+(\phi \epsilon_w+1)\epsilon_wvar[w(i)_t]+(\sigma+\frac{\alpha+\phi}{1-\alpha})\tilde{y}^2)  \}) + t.i.p \tag{14}
\end{eqnarray}
$$
最优货币政策最小化效用损失的贴现和：
$$
\begin{eqnarray}
\sum_{s=0}^\infty-\beta^s\frac{U(t+s)-U}{U_cC} &=&\sum_{s=0}^\infty\beta^s[-\frac{1}{\epsilon^p}\tilde{y}_t+\frac{1}{2}\{\frac{\epsilon_p}{\Theta}var[p(i)_t]+(\phi \epsilon_w+1)\epsilon_wvar[w(i)_t]+(\sigma+\frac{\alpha+\phi}{1-\alpha})\tilde{y}^2)  \}]\\
&=&\sum_{s=0}^\infty\beta^s[-\frac{1}{\epsilon^p}\tilde{y}_t+\frac{1}{2}\{\frac{\epsilon_p}{\lambda_p}{\pi_t^p}^2+\frac{\epsilon_w}{\lambda_w}{\pi_t^w}^2+(\sigma+\frac{\alpha+\phi}{1-\alpha})\tilde{y}^2)  \}] \tag{15}
\end{eqnarray} 
$$
**重要的是有几点说明**：

1. 虽然推导过程十分繁琐，但是最后的直觉是简单的，通胀和产出对自然均衡的偏离越大，效用损失越大。
2. 更一般的，最后一个等式中的$$\frac{1}{\epsilon_p}$$（在0.1的量级）可以换成更小的常数$$\Phi$$，这是因为，如果政府补贴企业雇佣劳动力，工资可以更接近劳动的边际产出，从而使社会总效率得到改善（但是注意到效用损失函数更大了，这**两者不矛盾，因为均衡水平提高了**。）书中认为$\Phi$的值是小量，因此至少是在百分之1的数量级，这就隐含着政府对扭曲进行了大量修正的假设。但是，我发现书本略去了第五章第143页公式（25）的证明，而经过我的推导，发现他在此处实际**仍把$\Phi$取值为$\frac{1}{\epsilon_p}$**，而这并不是一个足够小的量。这就很令人疑惑，小量近似有没有问题，目前还没有仔细验证。
3. 此处$$\tilde{y}$$并非产出缺口，而是产出与有效产出（efficient output $y^e$）的差值。有效产出之所以不等于自然产出，是因为厂商有垄断力量，（在没有补贴的情况下）工资不等于边际产出。书中并没有明确给出$$y^e$$的表达式，但是似乎从上两式的推导过程中不难得出$$y^e = \frac{(1+\phi)(1-\Phi)}{\sigma*(1-\alpha)+(1-\Phi)(\alpha+\phi)}$$。劳动力市场扭曲越大，有效产出越低。
4. 在只有价格粘性且扭曲完全修复的情况下，工资通胀不存在，至少理论上，遵循泰勒规则可以防止效率损失，即无论面临何种技术或者需求冲击，都能保持$$\pi=\tilde{y}=0$$。当然，实际上央行的反应不可能如此迅速。
5. 然而，两种名义粘性都存在时，即使是理论上，也不存在一种简单的利率规则，使得在面临外生技术冲击时，价格和工资的通胀都为零。试想，如要没有通胀，企业和劳动者必须同时认为工资是合意的，因而不会调整要价。但是外生的技术冲击直接影响自然真实工资，而货币政策对此无能为力，此时必定引发价格和工资变动。

正如上面所讨论的，我们到这里才能够开始讨论最优货币政策下，外生冲击对经济造成的影响，因为（理论上，零利率下限不紧，央行不相机决策）**只要有一个市场能够灵活调整价格，理论上就不会有任何造成效用损失的冲击！**求解最优政策的方法仍然为拉格朗日函数法，在此略去。下面直接给出遵循最优货币政策原则时，经济在外生**正向技术冲击**下的脉冲响应函数（货币政策以及总需求冲击都可以和工资灵活调整的情形一样控制）。当价格可以灵活调整时，最优政策是完全稳定住名义工资，由通缩来抬高实际工资；当工资灵活调整时，最优政策是完全稳定价格，由实际和名义工资提都高。当两种粘性都存在时，面对实际工资上涨的压力，最优政策是同时通缩并且让名义工资上涨，同时允许正的产出缺口；由于损失函数的凸性，最优策略是将冲击分散到三个变量中吸收。

<img src="https://www.github.com/yoursilver/yoursilver.github.io/blob/master/DSGE/6.wage_regidity/optimal_monetary_policy/wage_price_rigid_a.png?raw=true" style="zoom:67%;" />

# 疑问

> 在求解厂商和劳动者的定价方程（16）（17）时，书中“将一阶条件在平衡路径附近展开”省略了大部分代数（并不trivial），如何验证这样做的合理性？欢迎了解的朋友在评论区留言！
>
> 厂商决策的一阶条件$$E\sum_{k=0}^\infty\theta_p^k\{\frac{\Lambda_{t+k|t}}{P_{t+k}}Y_{t+k|t}(P_t^*-\mathcal{M}_p\Psi(Y_{t+k|t}))\}=0$$
>
> 推出$E\sum_{k=0}^\infty(\theta_p\beta)^k\{p_t^*-\mu_p-\psi_{t+k|t}\}=0$
>
> 以及劳动者的一节条件$$E\sum_{k=0}^\infty\theta_w^k\{\Lambda_{t+k|t}N(j)_{t+k|t}P_{t+k}({W_t^*}-P_{t+k}\mathcal{M}_wMRS\}=0$$
>
> 推出$E\sum_{k=0}^\infty(\theta_p\beta)^k\{w_t^*-p_{t+k}-\mu_w-mrs_{t+k|t}\}=0$